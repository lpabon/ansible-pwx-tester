System created with kubeup and where `inventory` is a link to the
vagrant inventory file:

```
/path/to/VM/.vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory
```

Which could have the following content:

```
# Generated by Vagrant

lpabon-k8s-1-node1 ansible_host=192.168.121.159 ansible_port=22 ansible_user='vagrant' ansible_ssh_private_key_file='/home/lpabon/.vagrant.d/insecure_private_key'
lpabon-k8s-1-master ansible_host=192.168.121.21 ansible_port=22 ansible_user='vagrant' ansible_ssh_private_key_file='/home/lpabon/.vagrant.d/insecure_private_key'
lpabon-k8s-1-node0 ansible_host=192.168.121.2 ansible_port=22 ansible_user='vagrant' ansible_ssh_private_key_file='/home/lpabon/.vagrant.d/insecure_private_key'
lpabon-k8s-1-node2 ansible_host=192.168.121.28 ansible_port=22 ansible_user='vagrant' ansible_ssh_private_key_file='/home/lpabon/.vagrant.d/insecure_private_key'

[master]
lpabon-k8s-1-master

[nodes]
lpabon-k8s-1-node0
lpabon-k8s-1-node1
lpabon-k8s-1-node2

[portworx]
lpabon-k8s-1-node0

[portworx_tester_node]
lpabon-k8s-1-node1
```

## Usage

* Update `global_vars.yml` accordingly
* Create an inventory file with your systems and have one section called
  `portworx` with a single node
* Run `ansible-playbook -i inventory site.yml`

## Sample run
```
$ ansible-playbook -i inventory site.yml

PLAY [nodes] ***************************************************************************************************

TASK [Gathering Facts] *****************************************************************************************
ok: [lpabon-k8s-1-node0]
ok: [lpabon-k8s-1-node2]
ok: [lpabon-k8s-1-node1]

TASK [common : install required packages] **********************************************************************
ok: [lpabon-k8s-1-node2]
ok: [lpabon-k8s-1-node0]
ok: [lpabon-k8s-1-node1]

TASK [security : get token from kubernetes] ********************************************************************
changed: [lpabon-k8s-1-node2]
changed: [lpabon-k8s-1-node0]
changed: [lpabon-k8s-1-node1]

TASK [security : set_fact] *************************************************************************************
ok: [lpabon-k8s-1-node0]
ok: [lpabon-k8s-1-node1]
ok: [lpabon-k8s-1-node2]

TASK [security : setup pxctl context] **************************************************************************
changed: [lpabon-k8s-1-node0]
changed: [lpabon-k8s-1-node1]
changed: [lpabon-k8s-1-node2]

PLAY [portworx] ************************************************************************************************

TASK [Gathering Facts] *****************************************************************************************
ok: [lpabon-k8s-1-node0]

TASK [volume : checking cluster status] ************************************************************************
changed: [lpabon-k8s-1-node0]

TASK [volume : check volume exists] ****************************************************************************
fatal: [lpabon-k8s-1-node0]: FAILED! => {"changed": true, "cmd": "/opt/pwx/bin/pxctl volume list | grep -w myvol", "delta": "0:00:00.100589", "end": "2020-03-11 21:18:53.817767", "msg": "non-zero return code", "rc": 1, "start": "2020-03-11 21:18:53.717178", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
...ignoring

TASK [volume : volume create] **********************************************************************************
changed: [lpabon-k8s-1-node0]

TASK [volume : set_fact] ***************************************************************************************
ok: [lpabon-k8s-1-node0]

TASK [volume : save variable across plays] *********************************************************************
changed: [lpabon-k8s-1-node0]

TASK [volume : volume inspect] *********************************************************************************
changed: [lpabon-k8s-1-node0]

PLAY [portworx_tester_node] ************************************************************************************

TASK [Gathering Facts] *****************************************************************************************
ok: [lpabon-k8s-1-node1]

TASK [volume-check : set_fact] *********************************************************************************
ok: [lpabon-k8s-1-node1]

TASK [volume-check : debug] ************************************************************************************
ok: [lpabon-k8s-1-node1] => {
    "msg": "testvolumeid 328859143492126170"
}

TASK [volume-check : delete volume] ****************************************************************************
changed: [lpabon-k8s-1-node1]

PLAY RECAP *****************************************************************************************************
lpabon-k8s-1-node0         : ok=12   changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=1
lpabon-k8s-1-node1         : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
lpabon-k8s-1-node2         : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

